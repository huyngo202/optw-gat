Instance   Model                Score      Time (ms) 
-------------------------------------------------------
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance c101 --model_name baseline_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 50000 --device cpu --generated
c101       baseline_bench       265.09     903       
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance c101 --model_name transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 22000 --device cpu --generated
Error running inference for c101 transformer_bench
Loading model for instance c101 ...
Loading TRANSFORMER model.
Infering routes for 64 generated instances...

  0%|          | 0/64 [00:00<?, ?it/s]
  0%|          | 0/64 [00:02<?, ?it/s]
Traceback (most recent call last):
  File "inference_optw_rl.py", line 222, in <module>
    which_inf=args.infe_type)
  File "/home/huyngo/Project/ML/optw_rl/src/inference_utils.py", line 118, in run_multiple
    model, which_inf=which_inf)
  File "/home/huyngo/Project/ML/optw_rl/src/inference_utils.py", line 90, in run_single
    args, run_episode_inf)
  File "/home/huyngo/Project/ML/optw_rl/src/inference_utils.py", line 35, in bs_inference
    seq, _ = run_episode(binst_data, bdata_scaled, start_time, dist_mat, 'greedy', nb)
  File "/home/huyngo/miniconda3/envs/optw_env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/huyngo/Project/ML/optw_rl/src/solution_construction.py", line 327, in forward
    blactions[:, step+1] = bpres_actions
IndexError: index 102 is out of bounds for dimension 1 with size 102

c101       transformer_bench    FAILED     FAILED    
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance c101 --model_name gat_lstm_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 5000 --device cpu --generated
Error running inference for c101 gat_lstm_bench
Loading model for instance c101 ...
Loading GAT-LSTM model with 3 GAT layer(s).
Infering routes for 64 generated instances...

  0%|          | 0/64 [00:00<?, ?it/s]
  2%|â–         | 1/64 [00:07<08:01,  7.64s/it]
  3%|â–Ž         | 2/64 [00:15<08:10,  7.91s/it]
  5%|â–         | 3/64 [00:21<07:04,  6.96s/it]
  6%|â–‹         | 4/64 [00:29<07:10,  7.17s/it]
  8%|â–Š         | 5/64 [00:34<06:15,  6.37s/it]
  9%|â–‰         | 6/64 [00:35<04:36,  4.77s/it]
 11%|â–ˆ         | 7/64 [00:36<03:22,  3.54s/it]
 12%|â–ˆâ–Ž        | 8/64 [00:40<03:20,  3.58s/it]
 14%|â–ˆâ–        | 9/64 [00:51<05:31,  6.03s/it]
 16%|â–ˆâ–Œ        | 10/64 [01:04<07:09,  7.95s/it]
 17%|â–ˆâ–‹        | 11/64 [01:07<05:50,  6.62s/it]
 19%|â–ˆâ–‰        | 12/64 [01:16<06:16,  7.25s/it]
 20%|â–ˆâ–ˆ        | 13/64 [01:20<05:21,  6.31s/it]
 22%|â–ˆâ–ˆâ–       | 14/64 [01:21<04:01,  4.83s/it]
 23%|â–ˆâ–ˆâ–Ž       | 15/64 [01:26<03:57,  4.84s/it]
 25%|â–ˆâ–ˆâ–Œ       | 16/64 [01:42<06:33,  8.21s/it]
 27%|â–ˆâ–ˆâ–‹       | 17/64 [01:54<07:11,  9.18s/it]
 28%|â–ˆâ–ˆâ–Š       | 18/64 [02:00<06:18,  8.22s/it]
 30%|â–ˆâ–ˆâ–‰       | 19/64 [02:03<05:00,  6.67s/it]
 31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [02:09<04:54,  6.69s/it]
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 21/64 [02:29<07:28, 10.43s/it]
 34%|â–ˆâ–ˆâ–ˆâ–      | 22/64 [02:31<05:35,  7.99s/it]
 36%|â–ˆâ–ˆâ–ˆâ–Œ     pr01       gat_transformer_bench 203.64     55807     
No checkpoint found for t101 gat_transformer_bench
t101       gat_transformer_bench FAILED     FAILED    

Saved results to results/generated_beam_results.csv
–ˆâ–ˆâ–     | 27/64 [02:41<01:46,  2.87s/it]
 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/64 [02:49<02:36,  4.35s/it]
 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 29/64 [02:55<02:45,  4.74s/it]
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 30/64 [03:15<05:21,  9.45s/it]
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [03:17<03:54,  7.11s/it]
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [03:28<04:27,  8.35s/it]
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [03:54<07:00, 13.56s/it]
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [04:01<05:45, 11.53s/it]
 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [04:05<04:29,  9.29s/it]
 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [04:21<05:14, 11.25s/it]
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 37/64 [04:29<04:44, 10.55s/it]
 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [04:42<04:46, 11.01s/it]
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [04:45<03:39,  8.77s/it]
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [04:50<03:02,  7.61s/it]
 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [04:51<02:12,  5.77s/it]
 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [05:03<02:47,  7.60s/it]
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 43/64 [05:04<01:55,  5.52s/it]
 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [05:22<03:02,  9.13s/it]
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 45/64 [05:24<02:15,  7.14s/it]
 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 46/64 [05:30<02:02,  6.79s/it]
 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 47/64 [05:49<02:57, 10.46s/it]
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [05:53<02:14,  8.43s/it]
 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [06:00<02:02,  8.17s/it]
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [06:03<01:32,  6.64s/it]
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 51/64 [06:05<01:06,  5.08s/it]
 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [06:30<02:11, 10.97s/it]
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [06:30<01:24,  7.71s/it]
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [06:30<00:55,  5.51s/it]
 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [06:49<01:27,  9.67s/it]
 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [07:13<01:50, 13.80s/it]
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [07:21<01:25, 12.17s/it]
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [07:23<00:54,  9.11s/it]
 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [08:02<01:30, 18.16s/it]
 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [08:03<00:51, 12.97s/it]
c101       gat_lstm_bench       FAILED     FAILED    
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance c101 --model_name gat_transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 5000 --device cpu --generated
Error running inference for c101 gat_transformer_bench
Loading model for instance c101 ...
Loading GAT-Transformer model with 3 GAT layer(s).
Infering routes for 64 generated instances...

  0%|          | 0/64 [00:00<?, ?it/s]
  2%|â–         | 1/64 [01:05<1:08:21, 65.10s/it]
  3%|â–Ž         | 2/64 [02:19<1:13:12, 70.84s/it]
  5%|â–         | 3/64 [04:24<1:37:07, 95.54s/it]
c101       gat_transformer_bench FAILED     FAILED    
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance r101 --model_name baseline_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 4000 --device cpu --generated
r101       baseline_bench       115.38     3406      
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance r101 --model_name transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 4000 --device cpu --generated
Error running inference for r101 transformer_bench
Loading model for instance r101 ...
Loading TRANSFORMER model.
Inferr101       gat_lstm_bench       115.45     16789     
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance r101 --model_name gat_transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 5000 --device cpu --generated
Error running inference for r101 gat_transformer_bench
Loading model for instance r101 ...
Loading GAT-Transformer model with 3 GAT layer(s).
Infering routes for 64 generated instances...

  0%|          | 0/64 [00:00<?, ?it/s]
  2%|â–         | 1/64 [00:07<08:16,  7.87s/it]
  3%|â–Ž         | 2/64 [00:09<04:31,  4.37s/it]
  5%|â–         | 3/64 [00:18<06:25,  6.31s/it]
  6%|â–‹         | 4/64 [00:19<04:23,  4.40s/it]
  8%|â–Š         | 5/64 [00:42<10:43, 10.91s/it]
  9%|â–‰         | 6/64 [00:48<09:01,  9.34s/it]
  9%|â–‰         | 6/64 [01:00<09:41, 10.02s/it]
Traceback (most recent call last):
  File "inference_optw_rl.py", line 222, in <module>
    which_inf=args.infe_type)
  File "/home/huyngo/Project/ML/optw_rl/src/inference_utils.py", line 118, in run_multiple
    model, which_inf=which_inf)
  File "/home/huyngo/Project/ML/optw_rl/src/inference_utils.py", line 90, in run_single
    args, run_episode_inf)
  File "/home/huyngo/Project/ML/optw_rl/src/inference_utils.py", line 35, in bs_inference
    seq, _ = run_episode(binst_data, bdat
r101       transformer_bench    FAILED     FAILED    
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance r101 --model_name gat_lstm_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 5000 --device cpu --generated
r101       gat_lstm_bench       115.45     16755     
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance r101 --model_name gat_transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 5000 --device cpu --generated
Error running inference for r101 gat_transformer_bench
Loading model for instance r101 ...
Loading GAT-Transformer model with 3 GAT layer(s).
Infering routes for 64 generated instances...

  0%|          | 0/64 [00:00<?, ?it/s]
  2%|â–         | 1/64 [00:11<12:07, 11.55s/it]
  3%|â–Ž         | 2/64 [00:14<06:34,  6.37s/it]
  5%|â–         | 3/64 [00:24<08:19,  8.19s/it]
  6%|â–‹         | 4/64 [00:25<05:22,  5.37s/it]
  8%|â–Š         | 5/64 [00:47<11:15, 11.45s/it]
  9%|â–‰         | 6/64 [00:53<09:10,  9.50s/it]
  9%|â–‰         | 6/64 [01:03<10:15, 10.60s/it]
Traceback (most recent call last):
  File "inference_optw_rl.py", line 222, in <module>
    which_inf=args.infe_type)
  File "/home/huyngo/Project/ML/optw_rl/src/inference_utils.py", line 118, in run_multiple
    model, which_inf=which_inf)
  File "/home/huyngo/Project/ML/optw_rl/src/inference_utils.py", line 90, in run_single
    args, run_episode_inf)
  File "/home/huyngo/Project/ML/optw_rl/src/inference_utils.py", line 35, in bs_inference
    seq, _ = run_episode(binst_data, bdata_scaled, start_time, dist_mat, 'greedy', nb)
  File "/home/huyngo/miniconda3/envs/optw_env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/huyngo/Project/ML/optw_rl/src/solution_construction.py", line 327, in forward
    blactions[:, step+1] = bpres_actions
IndexError: index 102 is out of bounds for dimension 1 with size 102

r101       gat_transformer_bench FAILED     FAILED    
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance rc101 --model_name baseline_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 4000 --device cpu --generated
rc101      baseline_bench       159.31     2668      
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance rc101 --model_name transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 4000 --device cpu --generated
rc101      transformer_bench    160.48     3064      
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance rc101 --model_name gat_lstm_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 5000 --device cpu --generated
rc101      gat_lstm_bench       159.41     11527     
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance rc101 --model_name gat_transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 5000 --device cpu --generated
rc101t101       transformer_bench    810.81     8900      
No checkpoint found for t101 gat_lstm_bench
t101       gat_lstm_bench       FAILED     FAILED    
No checkpoint found for t101 gat_transformer_bench
t101       gat_transformer_bench FAILED     FAILED    

Saved results to results/generated_beam_results.csv
  
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance pr01 --model_name transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 4000 --device cpu --generated
pr01       transformer_bench    196.28     1598      
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance pr01 --model_name gat_lstm_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 5000 --device cpu --generated
pr01       gat_lstm_bench       195.22     9167      
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance pr01 --model_name gat_transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 5000 --device cpu --generated
pr01       gat_transformer_bench 203.64     10995     
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance t101 --model_name baseline_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 4000 --device cpu --generated
t101       baseline_bench       810.7      6888      
Running: /home/huyngo/miniconda3/envs/optw_env/bin/python inference_optw_rl.py --instance t101 --model_name transformer_bench --infe_type bs --max_beam_number 128 --saved_model_epoch 4000 --device cpu --generated
t101       transformer_bench    810.81     9174      
No checkpoint found for t101 gat_lstm_bench
t101       gat_lstm_bench       FAILED     FAILED    
No checkpoint found for t101 gat_transformer_bench
t101       gat_transformer_bench FAILED     FAILED    

Saved results to results/generated_beam_results.csv
